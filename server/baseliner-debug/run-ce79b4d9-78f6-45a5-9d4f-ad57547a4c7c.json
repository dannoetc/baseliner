{
  "id": "ce79b4d9-78f6-45a5-9d4f-ad57547a4c7c",
  "device_id": "7a912a9e-acda-4100-b755-2a77fe523e33",
  "started_at": "2025-12-16T00:59:39.973085Z",
  "ended_at": "2025-12-16T00:59:50.315742Z",
  "status": "failed",
  "agent_version": "0.1.0-dev",
  "summary": {
    "ok": 1,
    "failed": 2,
    "itemsTotal": 3,
    "observed_state_hash": "59408b6dfdee46fdd3fa9c6fa5702a5914a55f34761e0521556a7742d39580d3"
  },
  "policy_snapshot": {
    "policy_id": "4d644430-d910-450c-8aa1-74395a1edb8c",
    "policy_name": "smoke-putty-7zip",
    "effective_policy_hash": "b1b5b9a754f8b70a7b5f0d5e40f4ff0c6642bcc8434fb82b540c0a1b0c5788a2"
  },
  "items": [
    {
      "id": "f8bbb513-43bd-4219-9c65-5a4718c7a65c",
      "ordinal": 0,
      "resource_type": "winget.package",
      "resource_id": "putty",
      "name": "PuTTY",
      "compliant_before": true,
      "compliant_after": true,
      "changed": false,
      "reboot_required": false,
      "status_detect": "ok",
      "status_remediate": "skipped",
      "status_validate": "ok",
      "started_at": "2025-12-16T00:59:42.045336Z",
      "ended_at": "2025-12-16T00:59:44.669468Z",
      "evidence": {
        "detect": {
          "stderr": "",
          "stdout": "No installed package found matching input criteria.",
          "version": null,
          "exit_code": 0,
          "installed": false
        },
        "validate": {
          "stderr": "",
          "stdout": "No installed package found matching input criteria.",
          "version": null,
          "exit_code": 0,
          "installed": false
        }
      },
      "error": {}
    },
    {
      "id": "9f5f7abf-68f5-4c8e-97ff-69dae37f9b94",
      "ordinal": 1,
      "resource_type": "winget.package",
      "resource_id": "7zip",
      "name": "7-Zip",
      "compliant_before": false,
      "compliant_after": false,
      "changed": false,
      "reboot_required": false,
      "status_detect": "ok",
      "status_remediate": "fail",
      "status_validate": "ok",
      "started_at": "2025-12-16T00:59:44.669468Z",
      "ended_at": "2025-12-16T00:59:50.315742Z",
      "evidence": {
        "detect": {
          "stderr": "",
          "stdout": "No installed package found matching input criteria.",
          "version": null,
          "exit_code": 0,
          "installed": false
        },
        "validate": {
          "stderr": "",
          "stdout": "No installed package found matching input criteria.",
          "version": null,
          "exit_code": 0,
          "installed": false
        },
        "remediate": {
          "action": "install",
          "stderr": "",
          "stdout": "No package found matching input criteria.",
          "exit_code": 2316632084
        }
      },
      "error": {
        "type": "winget_failed",
        "detail": "",
        "message": "winget install failed",
        "exit_code": 2316632084
      }
    },
    {
      "id": "a638d85e-55b1-455d-8724-0c4b43a96701",
      "ordinal": 2,
      "resource_type": "script.powershell",
      "resource_id": "marker",
      "name": "Write Baseliner marker (phase B)",
      "compliant_before": null,
      "compliant_after": null,
      "changed": false,
      "reboot_required": false,
      "status_detect": "fail",
      "status_remediate": "skipped",
      "status_validate": "skipped",
      "started_at": "2025-12-16T00:59:50.315742Z",
      "ended_at": "2025-12-16T00:59:50.315742Z",
      "evidence": {},
      "error": {
        "type": "invalid_resource",
        "message": "script.powershell missing detect"
      }
    }
  ],
  "logs": [
    {
      "id": "2ece8d5e-8039-435d-8a65-add542f53d68",
      "ts": "2025-12-16T00:59:44.669468Z",
      "level": "info",
      "message": "winget.package processed",
      "data": {
        "id": "putty",
        "changed": false,
        "success": true
      },
      "run_item_id": "f8bbb513-43bd-4219-9c65-5a4718c7a65c"
    },
    {
      "id": "5ddb0fe8-3662-4e87-9980-a85178bd11b4",
      "ts": "2025-12-16T00:59:50.315742Z",
      "level": "error",
      "message": "winget.package processed",
      "data": {
        "id": "7zip",
        "changed": false,
        "success": false
      },
      "run_item_id": "9f5f7abf-68f5-4c8e-97ff-69dae37f9b94"
    },
    {
      "id": "aa07647e-94cf-4bdf-9c2b-69ad2a213b6b",
      "ts": "2025-12-16T00:59:50.315742Z",
      "level": "error",
      "message": "script.powershell missing detect",
      "data": {
        "id": "marker"
      },
      "run_item_id": "a638d85e-55b1-455d-8724-0c4b43a96701"
    },
    {
      "id": "c8aab11a-26a7-4ef4-b071-1dc079e4b0c1",
      "ts": "2025-12-16T00:59:50.315742Z",
      "level": "info",
      "message": "Run finished",
      "data": {
        "ok": 1,
        "failed": 2,
        "status": "failed"
      },
      "run_item_id": null
    },
    {
      "id": "7135b41e-26f5-4da9-a4ad-365f32266d50",
      "ts": "2025-12-16T00:59:52.490565Z",
      "level": "info",
      "message": "Run started",
      "data": {
        "mode": "enforce",
        "resources": 3
      },
      "run_item_id": null
    }
  ]
}
